fun main () : int {
	
	var values : int[[]] = [
		[0, 1], 
		[2, 3],
		[4, 5], 
		[6, 7]
	];

	var sum : int = 0;

	parallel {
		// TODO: write function to make this automatic
		// for users
		var outersize: int = values.bounds[1] + ( values.bounds[1] % lang.thread_count ) / lang.thread_count;
		for (var outer : int = 0 to outersize) {
			outer = outer + lang.thread_index * values.bound[1];
			// slice
			var inner : int[] = values[outer];
			var localsum : int = 0;
			for (var i : int = 0 to inner.size()) {
				localsum = localsum + inner[i];
			}
			atomic {
				sum = sum + localsum;
			}
		}
	}
	
	
	return sum;
}

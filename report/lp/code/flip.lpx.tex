\begin{lstlisting}[caption={flip.lpx},label=lst:flip]
function void flip(image img) {
	for (int ri = 0; ri < img.height / 2; ri++) {
		// matrix slicing: get back array from index
		pixel[] toprow = img[ri];
		// 0-based indexing
		pixel[] bottomrow = img[img.height - ri - 1];
		for (int ci = 0; ci < img.width; ++ci) {
			// generic swap call in library
			lib.swap(toprow[ci], bottomrow[ci]);
		}
	}
}

function int main () {
	image img = lib.read("meow.png");
	flip(img);
	lib.save(img);
	
	// implicit return 0:
	// we want this to be able to work with
	// command-line environments as well
}
\end{lstlisting}
